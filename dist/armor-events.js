// armor-events v1.2.0 Mon Aug 10 2020  
!function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ArmorEvents=t():n.ArmorEvents=t()}("undefined"!=typeof self?self:this,function(){return function(n){var t={};function e(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return n[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=n,e.c=t,e.d=function(n,t,r){e.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:r})},e.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,t){if(1&t&&(n=e(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var o in n)e.d(r,o,function(t){return n[t]}.bind(null,o));return r},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},e.p="",e(e.s=0)}([function(n,t,e){"use strict";t.__esModule=!0,t.Channel=void 0;var r=e(1),o=function(n){return n&&n.__esModule?n:{default:n}}(r);o.default.Channel=r.Channel,t.Channel=r.Channel,t.default=o.default,n.exports=o.default},function(n,t,e){"use strict";t.__esModule=!0,t.Channel=void 0;var r=function(n){return n&&n.__esModule?n:{default:n}}(e(2));var o=function(n){return function(){return"channel"+n++}}(0),i=function(n){return function(){return"binding"+n++}}(0),s="data",u="pipe",a=function(){function n(){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.id=o(),this.events=new r.default,this.upstream=null,this.downstreams={},this.bindings={}}return n.prototype.canPipe=function(n){return!f(this,n)},n.prototype.clean=function(){return this.detach().unpipe().off(),this},n.prototype.detach=function(){return this.upstream&&(this.upstream instanceof r.default?(this.upstream.off(null,this.feed,this),this.upstream=null):this.upstream.unpipe(this)),this},n.prototype.feed=function(){for(var n,t,e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];return(n=this.events).trigger.apply(n,[s].concat(r)),(t=this.events).trigger.apply(t,[u].concat(r)),this},n.prototype.feedAsync=function(){for(var n,t,e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];return(n=this.events).triggerAsync.apply(n,[s].concat(r)),(t=this.events).triggerAsync.apply(t,[u].concat(r)),this},n.prototype.onData=function(n,t){var e=this,r=i(),o=this.events.on(s,n,t),u=function(){delete e.bindings[r],o()},a={id:r,unbind:u,cb:n,ctx:t};return this.bindings[r]=a,u},n.prototype.onceData=function(n,t){var e=this,r=i(),o=this.events.once(s,function(){for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];n.apply(t,r),u()},t),u=function(){delete e.bindings[r],o()},a={id:r,unbind:u,cb:n,ctx:t};return this.bindings[r]=a,u},n.prototype.off=function(n,t){for(var e=c(this.bindings),r=0;r<e.length;r++){var o=e[r],i=o.unbind,s=o.cb,u=o.ctx;null!=n&&n!==s||null!=t&&t!==u||i()}return this},n.prototype.pipe=function(n,t){var e=this,r=f(this,n);if(r)throw Error(r);var o=this.events.on(u,function(){"function"==typeof t?Promise.resolve(t.apply(void 0,arguments)).then(function(t){return n.feed(t)}):n.feed.apply(n,arguments)});return this.downstreams[n.id]={id:n.id,unbind:function(){delete e.downstreams[n.id],n.upstream=null,o()},channel:n},n.upstream=this,this},n.prototype.unpipe=function(){for(var n=this,t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];0===e.length&&(e=c(this.downstreams).map(function(n){return n.channel}));e.map(function(t){var e=t?t.id:null;if(e){var r=(n.downstreams[e]||{}).unbind;r&&r()}});return this},n}(),f=function(n,t){if(t.upstream)throw"subchannel has already had an upstream channel.";if(n.upstream&&l(t,n))throw"it can not be circular pipe.";return!1},c=function(n){var t=[];for(var e in n)t.push(n[e]);return t},l=function n(t,e){if(t===e)return!0;if(t.downstreams[e.id])return!0;for(var r in t.downstreams)if(n(t.downstreams[r].channel,e))return!0;return!1};r.default.prototype.channel=function(n){var t=new a;return t.upstream=this,this.on(n,t.feed,t),t},t.Channel=a,t.default=r.default},function(n,t,e){"use strict";t.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},o=e(3),i=e(5),s=e(6),u=e(8),a=e(7),f=e(9),c=e(4),l={listenTo:function(n,t,e,r){(0,o.checkOwner)(this),(0,o.checkOwner)(n);var u=(0,s.listenTo)(this,n,t,e,r);return u.length?function(){return(0,i.destroy)(n,u)}:c.noop},listenToOnce:function(n,t,e,r){(0,o.checkOwner)(this),(0,o.checkOwner)(n);var u=(0,s.listenTo)(this,n,t,e,r,!0);return u.length?function(){return(0,i.destroy)(n,u)}:c.noop},off:function(n,t,e){return(0,u.off)(this,n,t,e),this},on:function(n,t,e){var r=this;(0,o.checkOwner)(this);var s=(0,a.on)(this,n,t,e);return s.length?function(){return(0,i.destroy)(r,s)}:c.noop},once:function(n,t,e){var r=this;(0,o.checkOwner)(this);var s=(0,a.on)(this,n,t,e,!0);return s.length?function(){return(0,i.destroy)(r,s)}:c.noop},stopListening:function(n,t,e,r){return(0,u.stopListening)(this,n,t,e,r),this},trigger:function(n){if(this._armorEvents){for(var t=arguments.length,e=Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];(0,f.trigger)(this,n,e)}return this},triggerAsync:function(n){if(this._armorEvents){for(var t=arguments.length,e=Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];(0,f.trigger)(this,n,e,!0)}return this}};function h(n){for(var t in l)n[t]=l[t];return n}function v(n){if(!(this instanceof v)){var t=void 0===n?"undefined":r(n);return h(!n||"object"!==t&&"function"!==t?{}:n)}}h(v.prototype),h(v),t.default=v},function(n,t,e){"use strict";t.__esModule=!0,t.checkOwner=void 0;var r=e(4);t.checkOwner=function(n){n._armorEvents||(n._armorEvents={id:(0,r.uniqueId)("a"),events:{},handlers:{},listenings:{}})}},function(n,t,e){"use strict";t.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};function o(n){return"symbol"===(void 0===n?"undefined":r(n))}function i(n){return"function"==typeof n}function s(n){return n instanceof Array}function u(n,t){return n.indexOf(t)>-1}function a(n){return n.replace(/^\s+|\s+$/g,"")}function f(n,t){u(n,t)||n.push(t)}var c={};t.canUseSymbol=function(){return"function"==typeof Symbol},t.includes=u,t.isFunction=i,t.isObject=function(n){return n&&"object"===(void 0===n?"undefined":r(n))&&!s(n)},t.isSymbol=o,t.keys=function(n){var t=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(n):[];for(var e in n)n.hasOwnProperty(e)&&t.push(e);return t},t.makeEventList=function n(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(function(n){return"string"==typeof n}(t))(t=a(t))&&(function(n){return!/\s/.test(n)}(t)?f(r,t):n(function(n){return a(n).split(/\s+/)}(t),e,r));else if(s(t))for(var u=0;u<t.length;u++)n(t[u],e,r);else!function(n){return"number"==typeof n}(t)?o(t)?f(r,t):e&&i(t)&&f(r,t):n(t+"",e,r);return r},t.noop=function(){},t.uniqueId=function(n){return c.hasOwnProperty(n)||(c[n]=0),n+c[n]++}},function(n,t,e){"use strict";t.__esModule=!0,t.destroyApi=t.destroy=void 0;var r=e(4);function o(n,t){var e=n._armorEvents,o=e.id,i=e.handlers,s=e.events,u=i[t];if(u){u.disabled=!0,delete i[t];var a=u.event,f=u.listener;if(function(n,t,e){var r=n[t];if(r){var o=r.indexOf(e);o>-1&&r.splice(o,1),r.length||delete n[t]}}(s,a,t),f)!function(n,t,e,o){var i=n[t];if(i){var s=i.events;if(s){var u=s[e];if(u){var a=u.indexOf(o);a>-1&&u.splice(a,1),u.length||delete s[e]}(0,r.keys)(s).length||delete n[t]}}}(f._armorEvents.listenings,o,a,t)}}t.destroy=function(n,t){if(n&&n._armorEvents&&t&&t.length)for(var e=0;e<t.length;e++)o(n,t[e])},t.destroyApi=o},function(n,t,e){"use strict";t.__esModule=!0,t.listenTo=void 0;var r=e(7),o=e(4);function i(n,t,e,o,i,s){var u=(0,r.onApi)(t,e,o,i,s,n),a=t._armorEvents.id,f=n._armorEvents.listenings,c=f[a];c||(c=f[a]={target:t,events:{}});var l=c.events,h=l[e];return h||(h=l[e]=[]),h.push(u),u}function s(n,t,e,r,s,u){var a=(0,o.makeEventList)(e);r=(0,o.makeEventList)(r,!0);var f=[];if(a.length&&r.length)for(var c=0;c<a.length;c++)for(var l=0;l<r.length;l++)"all"!==r[l]&&f.push(i(n,t,a[c],r[l],s||n,u));return f}t.listenTo=function(n,t,e,r,i,u){var a=[];if((0,o.isObject)(e)){u=i,i=r;for(var f=(0,o.keys)(e),c=0;c<f.length;c++)a=a.concat(s(n,t,f[c],e[f[c]],i,u))}else a=s(n,t,e,r,i,u);return a}},function(n,t,e){"use strict";t.__esModule=!0,t.onApi=t.on=void 0;var r=e(4);function o(n,t,e,o,i,s){var u=n._armorEvents,a=u.events,f=u.handlers,c=(0,r.uniqueId)("h"),l=f[c]={id:c,event:t,handle:e,ctx:o,once:!!i,handleType:(0,r.isFunction)(e)?0:1};return(0,r.isObject)(s)&&(l.listener=s),(a[t]||(a[t]=[])).push(c),c}function i(n,t,e,i,s){var u=(0,r.makeEventList)(t);e=(0,r.makeEventList)(e,!0);var a=[];if(u.length&&e.length)for(var f=0;f<u.length;f++)for(var c=0;c<e.length;c++)"all"!==e[c]&&e[c]!==u[f]&&a.push(o(n,u[f],e[c],i||n,s));return a}t.on=function(n,t,e,o,s){var u=[];if((0,r.isObject)(t)){s=o,o=e;for(var a=(0,r.keys)(t),f=0;f<a.length;f++)u=u.concat(i(n,a[f],t[a[f]],o,s))}else u=i(n,t,e,o,s);return u},t.onApi=o},function(n,t,e){"use strict";t.__esModule=!0,t.stopListening=t.off=void 0;var r=e(5),o=e(4);function i(n,t,e){var r=[];null!=t&&(t=(0,o.makeEventList)(t,!0));for(var i=0;i<n.length;i++){var s=n[i];(null==t||(0,o.includes)(t,s.handle))&&(null!=e&&e!==s.ctx||r.push(s.id))}return r}t.off=function(n,t,e,s){if(n._armorEvents){var u=i(function(n,t){var e=n._armorEvents,r=e.events,i=e.handlers;t=null==t?(0,o.keys)(r):(0,o.makeEventList)(t);for(var s=[],u=0;u<t.length;u++){var a=r[t[u]];if(a)for(var f=0;f<a.length;f++){var c=i[a[f]];c&&s.push(c)}}return s}(n,t),e,s);(0,r.destroy)(n,u)}},t.stopListening=function(n,t,e,s,u){if(n._armorEvents){var a=n._armorEvents.listenings,f=[];if((0,o.isObject)(t)){if(!t._armorEvents)return;var c=a[t._armorEvents.id];c&&f.push(c)}else for(var l=(0,o.keys)(a),h=0;h<l.length;h++)f.push(a[l[h]]);null!=e&&(e=(0,o.makeEventList)(e));for(var v=0;v<f.length;v++){for(var d=f[v],p=d.target,y=d.events,g=e||(0,o.keys)(y),m=p._armorEvents.handlers,b=[],_=0;_<g.length;_++){var w=y[g[_]];if(w)for(var E=0;E<w.length;E++){var O=m[w[E]];O&&b.push(O)}}(0,r.destroy)(p,i(b,s,u))}}}},function(n,t,e){"use strict";t.__esModule=!0,t.trigger=void 0;var r=e(4),o=e(5),i=[],s=!1;function u(n){var t=n.handler,e=n.args,r=n.owner,i=n.event;if(n.all)a(r,"all",[i].concat(e));else{var s=t.id,u=t.handle,f=t.handleType,c=t.ctx,l=t.once,h=t.listener;t.disabled||(l&&(0,o.destroyApi)(r,s),0===f?u.apply(c,e):a(h||r,u,e))}}function a(n,t,e,r){var o=n._armorEvents,a=o.events,f=o.handlers,c=a[t],l=[];if(c)for(var h=0;h<c.length;h++){var v=f[c[h]];v&&l.push({handler:v,args:e,owner:n,async:r})}"all"!==t&&i.unshift({all:!0,event:t,owner:n,async:r,args:e});for(var d=l.length-1;d>-1;d--)i.unshift(l[d]);!function(){if(!s){for(s=!0;i.length;){var n=i.shift();if(n.async)setTimeout(u,0,n);else try{u(n)}catch(n){throw s=!1,n}}s=!1}}()}t.trigger=function(n,t,e,o){t=(0,r.makeEventList)(t);for(var i=0;i<t.length;i++)a(n,t[i],e,o)}}])});