// armor-events v1.0.1 Wed Sep 25 2019  
!function(n,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ArmorEvents=e():n.ArmorEvents=e()}("undefined"!=typeof self?self:this,function(){return function(n){var e={};function t(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return n[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=n,t.c=e,t.d=function(n,e,r){t.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:r})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,e){if(1&e&&(n=t(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var o in n)t.d(r,o,function(e){return n[e]}.bind(null,o));return r},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p="",t(t.s=0)}([function(n,e,t){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},o=t(1),i=t(3),s=t(4),u=t(6),f=t(5),a=t(7),c=t(2),l={listenTo:function(n,e,t,r){(0,o.checkOwner)(this),(0,o.checkOwner)(n);var u=(0,s.listenTo)(this,n,e,t,r);return u.length?function(){return(0,i.destroy)(n,u)}:c.noop},listenToOnce:function(n,e,t,r){(0,o.checkOwner)(this),(0,o.checkOwner)(n);var u=(0,s.listenTo)(this,n,e,t,r,!0);return u.length?function(){return(0,i.destroy)(n,u)}:c.noop},off:function(n,e,t){return(0,u.off)(this,n,e,t),this},on:function(n,e,t){var r=this;(0,o.checkOwner)(this);var s=(0,f.on)(this,n,e,t);return s.length?function(){return(0,i.destroy)(r,s)}:c.noop},once:function(n,e,t){var r=this;(0,o.checkOwner)(this);var s=(0,f.on)(this,n,e,t,!0);return s.length?function(){return(0,i.destroy)(r,s)}:c.noop},stopListening:function(n,e,t,r){return(0,u.stopListening)(this,n,e,t,r),this},trigger:function(n){if(this._armorEvents){for(var e=arguments.length,t=Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];(0,a.trigger)(this,n,t)}return this},triggerAsync:function(n){if(this._armorEvents){for(var e=arguments.length,t=Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];(0,a.trigger)(this,n,t,!0)}return this}};function v(n){for(var e in l)n[e]=l[e];return n}function h(n){var e=void 0===n?"undefined":r(n);return v(!n||"object"!==e&&"function"!==e?{}:n)}v(h),n.exports=h},function(n,e,t){"use strict";e.__esModule=!0,e.checkOwner=void 0;var r=t(2);e.checkOwner=function(n){n._armorEvents||(n._armorEvents={id:(0,r.uniqueId)("a"),events:{},handlers:{},listenings:{}})}},function(n,e,t){"use strict";e.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};function o(n){return"symbol"===(void 0===n?"undefined":r(n))}function i(n){return"function"==typeof n}function s(n){return n instanceof Array}function u(n,e){return n.indexOf(e)>-1}function f(n){return n.replace(/^\s+|\s+$/g,"")}function a(n,e){u(n,e)||n.push(e)}var c={};e.includes=u,e.isFunction=i,e.isObject=function(n){return n&&"object"===(void 0===n?"undefined":r(n))&&!s(n)},e.isSymbol=o,e.keys=function(n){var e=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(n):[];for(var t in n)n.hasOwnProperty(t)&&e.push(t);return e},e.makeEventList=function n(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(function(n){return"string"==typeof n}(e))(e=f(e))&&(function(n){return!/\s/.test(n)}(e)?a(r,e):n(function(n){return f(n).split(/\s+/)}(e),t,r));else if(s(e))for(var u=0;u<e.length;u++)n(e[u],t,r);else!function(n){return"number"==typeof n}(e)?o(e)?a(r,e):t&&i(e)&&a(r,e):n(e+"",t,r);return r},e.noop=function(){},e.uniqueId=function(n){return c.hasOwnProperty(n)||(c[n]=0),n+c[n]++}},function(n,e,t){"use strict";e.__esModule=!0,e.destroyApi=e.destroy=void 0;var r=t(2);function o(n,e){var t=n._armorEvents,o=t.id,i=t.handlers,s=t.events,u=i[e];if(u){delete i[e];var f=u.event,a=u.listener;if(function(n,e,t){var r=n[e];if(r){var o=r.indexOf(t);o>-1&&r.splice(o,1),r.length||delete n[e]}}(s,f,e),a)!function(n,e,t,o){var i=n[e];if(i){var s=i.events;if(s){var u=s[t];if(u){var f=u.indexOf(o);f>-1&&u.splice(f,1),u.length||delete s[t]}(0,r.keys)(s).length||delete n[e]}}}(a._armorEvents.listenings,o,f,e)}}e.destroy=function(n,e){if(n&&n._armorEvents&&e&&e.length)for(var t=0;t<e.length;t++)o(n,e[t])},e.destroyApi=o},function(n,e,t){"use strict";e.__esModule=!0,e.listenTo=void 0;var r=t(5),o=t(2);function i(n,e,t,o,i,s){var u=(0,r.onApi)(e,t,o,i,s,n),f=e._armorEvents.id,a=n._armorEvents.listenings,c=a[f];c||(c=a[f]={target:e,events:{}});var l=c.events,v=l[t];return v||(v=l[t]=[]),v.push(u),u}function s(n,e,t,r,s,u){var f=(0,o.makeEventList)(t);r=(0,o.makeEventList)(r,!0);var a=[];if(f.length&&r.length)for(var c=0;c<f.length;c++)for(var l=0;l<r.length;l++)"all"!==r[l]&&a.push(i(n,e,f[c],r[l],s||n,u));return a}e.listenTo=function(n,e,t,r,i,u){var f=[];if((0,o.isObject)(t)){u=i,i=r;for(var a=(0,o.keys)(t),c=0;c<a.length;c++)f=f.concat(s(n,e,a[c],t[a[c]],i,u))}else f=s(n,e,t,r,i,u);return f}},function(n,e,t){"use strict";e.__esModule=!0,e.onApi=e.on=void 0;var r=t(2);function o(n,e,t,o,i,s){var u=n._armorEvents,f=u.events,a=u.handlers,c=(0,r.uniqueId)("h"),l=a[c]={id:c,event:e,handle:t,ctx:o,once:!!i,handleType:(0,r.isFunction)(t)?0:1};return(0,r.isObject)(s)&&(l.listener=s),(f[e]||(f[e]=[])).push(c),c}function i(n,e,t,i,s){var u=(0,r.makeEventList)(e);t=(0,r.makeEventList)(t,!0);var f=[];if(u.length&&t.length)for(var a=0;a<u.length;a++)for(var c=0;c<t.length;c++)"all"!==t[c]&&t[c]!==u[a]&&f.push(o(n,u[a],t[c],i||n,s));return f}e.on=function(n,e,t,o,s){var u=[];if((0,r.isObject)(e)){s=o,o=t;for(var f=(0,r.keys)(e),a=0;a<f.length;a++)u=u.concat(i(n,f[a],e[f[a]],o,s))}else u=i(n,e,t,o,s);return u},e.onApi=o},function(n,e,t){"use strict";e.__esModule=!0,e.stopListening=e.off=void 0;var r=t(3),o=t(2);function i(n,e,t){var r=[];null!=e&&(e=(0,o.makeEventList)(e,!0));for(var i=0;i<n.length;i++){var s=n[i];(null==e||(0,o.includes)(e,s.handle))&&(null!=t&&t!==s.ctx||r.push(s.id))}return r}e.off=function(n,e,t,s){if(n._armorEvents){var u=i(function(n,e){var t=n._armorEvents,r=t.events,i=t.handlers;e=null==e?(0,o.keys)(r):(0,o.makeEventList)(e);for(var s=[],u=0;u<e.length;u++){var f=r[e[u]];if(f)for(var a=0;a<f.length;a++){var c=i[f[a]];c&&s.push(c)}}return s}(n,e),t,s);(0,r.destroy)(n,u)}},e.stopListening=function(n,e,t,s,u){if(n._armorEvents){var f=n._armorEvents.listenings,a=[];if((0,o.isObject)(e)){if(!e._armorEvents)return;var c=f[e._armorEvents.id];c&&a.push(c)}else for(var l=(0,o.keys)(f),v=0;v<l.length;v++)a.push(f[l[v]]);null!=t&&(t=(0,o.makeEventList)(t));for(var h=0;h<a.length;h++){for(var d=a[h],y=d.target,p=d.events,g=t||(0,o.keys)(p),m=y._armorEvents.handlers,b=[],_=0;_<g.length;_++){var E=p[g[_]];if(E)for(var O=0;O<E.length;O++){var k=m[E[O]];k&&b.push(k)}}(0,r.destroy)(y,i(b,s,u))}}}},function(n,e,t){"use strict";e.__esModule=!0,e.trigger=void 0;var r=t(2),o=t(3),i=[],s=!1;function u(n){var e=n.handler,t=n.args,r=n.owner,i=n.event;if(n.all)f(r,"all",[i].concat(t));else{var s=r._armorEvents.handlers,u=e.id,a=e.handle,c=e.handleType,l=e.ctx,v=e.once,h=e.listener;s[u]&&(0===c?a.apply(l,t):f(h||r,a,t),v&&(0,o.destroyApi)(r,u))}}function f(n,e,t,r){var o=n._armorEvents,f=o.events,a=o.handlers,c=f[e],l=[];if(c)for(var v=0;v<c.length;v++){var h=a[c[v]];h&&l.push({handler:h,args:t,owner:n,async:r})}"all"!==e&&i.unshift({all:!0,event:e,owner:n,async:r,args:t});for(var d=l.length-1;d>-1;d--)i.unshift(l[d]);!function(){if(!s){for(s=!0;i.length;){var n=i.shift();if(n.async)setTimeout(u,0,n);else try{u(n)}catch(n){throw s=!1,n}}s=!1}}()}e.trigger=function(n,e,t,o){e=(0,r.makeEventList)(e);for(var i=0;i<e.length;i++)f(n,e[i],t,o)}}])});